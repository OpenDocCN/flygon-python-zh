# 前言

在一个时代，**应用程序开发人员**几乎总是意味着**网络应用程序开发人员**的时代，构建桌面 GUI 应用程序似乎有可能变成一种古雅而晦涩的艺术。然而，在每一个讨论编程的论坛、邮件列表和聊天服务中，我发现年轻的 Python 编程人员渴望深入研究 GUI 工具包，以便开始构建任何普通人都可以轻松识别为应用程序的软件。对于这些学习者一直推荐的一个 GUI 库，也可以说是 Python 最令人兴奋和最完整的工具包，就是 PyQt。

尽管 PyQt 很受欢迎，但学习 PyQt 的资源相对较少。那些希望学习它的人必须严重依赖过时的书籍、C++文档、零散的博客或在邮件列表或 Stack Overflow 帖子中找到的代码片段。显然，Python 程序员需要一本现代的 PyQt 教程和参考书，而这本书旨在填补这一需求。

我的第一本书《使用 Tkinter 进行 Python GUI 编程》专注于使用 Tkinter 进行应用程序开发的基础知识，涵盖了诸如界面设计、单元测试、程序架构和打包等核心主题。在这本书中，我希望超越基础知识，不仅教你如何构建数据驱动的业务表单（许多工具包都可以生成，许多其他书籍都可以教你编写），而且探索 PyQt 提供的更令人兴奋和独特的可能性：多媒体、动画、3D 图形、图像处理、网络、多线程等。当然，这本书也不会忽视业务方面的内容，包括数据输入表单、SQL 数据库和图表。

写技术书籍的作者有两种。第一种是绝对的专家，具有不可动摇的权威和对所讨论主题的百科全书式知识，能够凭借深刻的理解力提供完美地满足学习者最迫切需求的解释。

第二种作者是一个普通人，具有对基础知识的合理熟悉度，愿意研究未知的内容，最重要的是，他们有顽强的决心，确保印刷出版的每一种陈述都是完整和正确的真相。这种作者必须准备好在写作过程中停下来，测试解释器或代码编辑器中的声明；花费数小时阅读文档、邮件列表线程、代码注释和 IRC 日志，以追求更正确的理解；当新的事实揭示了他们最初的假设存在错误时，删除和重写大部分工作。

当有人要求我写一本关于 PyQt5 的书时，我不能声称自己是第一种作者（现在也不行）；虽然我在工作中和开源世界中开发和维护了几个 PyQt 应用程序，但我对 PyQt 的理解很少超出我自己代码的简单需求。因此，我立志成为第二种类型的作者，致力于勤奋学习和费力地将可用信息的混乱大量筛选和提炼成一篇文章，以指导有抱负的 GUI 程序员掌握 PyQt。

作为五个孩子的自豪父亲，其中一些孩子对编程有着萌芽（如果不是蓬勃）的兴趣，我在过去的六个月里努力写了一本书，如果他们希望学习这些技能，我可以自信和认真地放在他们面前。亲爱的读者，我希望你在这本书中感受到我的父母对你的成长和进步的热情，我们一起攻克这个主题。

# 这本书是为谁写的

本书适用于希望深入了解 PyQt 应用程序框架并学习如何制作强大 GUI 应用程序的中级 Python 程序员。假设读者了解 Python 语法、特性和习惯用法，如函数、类和常见标准库工具。还假设读者有一个可以舒适地编写和执行 Python 代码的环境。

本书不假设读者具有任何 GUI 开发、其他 GUI 工具包或其他版本的 PyQt 的先前知识。

# 本书涵盖内容

第一章《PyQt 入门》，向您介绍了 Qt 和 PyQt 库。您将学习如何设置系统以编写 PyQt 应用程序，并介绍 Qt Designer。您还将编写传统的`Hello World`应用程序，并开发 PyQt 应用程序的基本模板。

第二章《使用 QtWidgets 构建表单》，向您展示了制作 PyQt GUI 的基础知识。您将了解最常见的输入和显示小部件，学会使用布局来排列它们，并学会验证用户输入。您将应用这些技能来开发日历 GUI。

第三章《使用信号和槽处理事件》，专注于 PyQt 的事件处理和对象通信系统。您将学习如何使用此系统使应用程序响应用户输入，以及如何创建自定义信号和槽。您将通过完成日历应用程序来应用这些技能。

第四章《使用 QMainWindow 构建应用程序》，向您介绍了`QMainWindow`类，它是本书其余部分应用程序的基础。您还将探索 PyQt 的标准对话框类和`QSettings`模块，用于保存应用程序的配置。

第五章《使用模型视图类创建数据接口》，专注于 Qt 的模型视图类。您将学习模型视图设计原则，探索`QtWidgets`中的模型视图类，并在开发 CSV 编辑器时练习您的知识。

第六章《美化 Qt 应用程序》，探讨了 PyQt 小部件的样式能力。您将通过自定义字体、图像和图标为 GUI 应用程序增添趣味。您将学会使用样式对象和 Qt 样式表自定义颜色。最后，我们将学习如何对样式属性进行基本动画。

第七章《使用 QtMultimedia 处理音视频》，探索了 Qt 的多媒体功能。您将学习如何在各个平台上无缝播放和录制音频和视频。

第八章《使用 QtNetwork 进行网络通信》，专注于使用`QtNetwork`库进行简单的网络通信。您将学习如何通过原始套接字进行通信，包括**传输控制协议**（**TCP**）和**用户数据报协议**（**UDP**），以及学习如何使用 HTTP 传输和接收文件和数据。

第九章《使用 QtSQL 探索 SQL》，向您介绍了 SQL 数据库编程的世界。您将学习 SQL 的基础知识和 SQLite 数据库。然后，您将学习您的 PyQt 应用程序如何使用`QtSQL`库来使用原始 SQL 命令或 Qt 的 SQL 模型视图类访问数据。

第十章《使用 QTimer 和 QThread 进行多线程》，介绍了多线程和异步编程的世界。您将学习如何使用定时器延迟事件循环中的任务，并学习如何使用`QThread`将进程推入单独的执行线程。您还将学习如何使用`QThreadPool`进行高并发编程。

《第十一章》，*使用 QTextDocument 创建丰富文本*，探索了 Qt 中的丰富文本和文档准备。你将了解 Qt 的丰富文本标记语言，并学习如何使用`QTextDocument`以编程方式构建文档。你还将学习如何使用 Qt 的打印库，轻松实现跨平台的文档打印。

《第十二章》，*使用 Qpainter 创建 2D 图形*，深入探讨了 Qt 中的二维图形。你将学习如何加载和编辑图像，创建自定义小部件。你还将了解使用 Qt 图形系统进行绘制和动画，并创建一个街机风格的游戏。

《第十三章》，*使用 QtOpenGL 创建 3D 图形*，向你介绍了 OpenGL 的 3D 图形。你将学习现代 OpenGL 编程的基础知识，以及如何使用 PyQt 小部件来显示和与 OpenGL 图形进行交互。

《第十四章》，*使用 QtCharts 嵌入数据图表*，探索了 Qt 内置的图表功能。你将学习如何创建静态和动画图表，以及如何自定义图表的颜色、字体和样式。

《第十五章》，*PyQt 树莓派*，着重介绍了在树莓派计算机上使用 PyQt。你将学习如何在 Raspbian Linux 上设置 PyQt，以及如何将 PyQt 的强大功能与树莓派的 GPIO 引脚结合起来，创建与真实电路交互的 GUI 应用程序。

《第十六章》，*使用 QtWebEngine 进行网页浏览*，探讨了 PyQt 的基于 Chromium 的网页浏览器模块。你将在构建自己的多标签网页浏览器时探索这个模块的功能。

《第十七章》，*为软件分发做准备*，讨论了准备代码进行共享和分发的各种方法。我们将研究最佳的项目布局，使用`setuptools`为其他 Python 用户打包源代码，以及使用 PyInstaller 构建独立可执行文件。

《附录 A》，*问题的答案*，包含了每章末尾问题的答案或建议。

《附录 B》，*将 Raspbian 9 升级到 Raspbian 10*，解释了如何将树莓派设备从 Raspbian 9 升级到 Raspbian 10，供那些在正式发布 Raspbian 10 之前尝试跟随本书的读者参考。

# 为了充分利用本书

读者应该精通 Python 语言，特别是 Python 3。你应该至少在基本层面上理解如何使用类和面向对象编程。如果你对 C++有一定的了解，可能会有所帮助，因为大部分可用的 Qt 文档都是针对这种语言的。

你应该有一台安装了 Python 3.7 的 Windows、macOS 或 Linux 系统的计算机，并且可以根据需要安装其他软件。你应该有一个你熟悉的代码编辑器和命令行 shell。最后，你应该能够接入互联网。

本书的每一章都包含一个或多个示例应用。尽管这些示例可以下载，但鼓励你跟着操作，手动创建这些应用程序，以便看到应用程序在中间阶段的形成过程。

每一章还包含一系列问题或建议的项目，以巩固你对主题的知识，并提供了一些资源供进一步学习。如果你在解决这些问题和阅读提供的材料时能够运用你的头脑和创造力，你将能够充分利用每一章。

本书中包含的代码是根据开源 MIT 许可发布的，允许您根据自己的需要重复使用代码，前提是您保留了包含的版权声明。鼓励您使用、修改、改进和重新发布这些程序。

# 下载示例代码文件

您可以从[www.packt.com](http://www.packt.com)的帐户中下载本书的示例代码文件。如果您在其他地方购买了本书，可以访问[www.packt.com/support](http://www.packt.com/support)并注册，以便将文件直接发送到您的邮箱。

您可以按照以下步骤下载代码文件：

1.  在[www.packt.com](http://www.packt.com)上登录或注册。

1.  选择“支持”选项卡。

1.  单击“代码下载和勘误”。

1.  在搜索框中输入书名，然后按照屏幕上的说明操作。

文件下载后，请确保使用最新版本的以下工具解压或提取文件夹：

+   WinRAR/7-Zip 适用于 Windows

+   Zipeg/iZip/UnRarX 适用于 Mac

+   7-Zip/PeaZip 适用于 Linux

本书的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/Mastering-GUI-Programming-with-Python/tree/master`](https://github.com/PacktPublishing/Mastering-GUI-Programming-with-Python/tree/master)。如果代码有更新，将在现有的 GitHub 存储库上进行更新。

我们还提供了来自我们丰富书籍和视频目录的其他代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)上找到。快去看看吧！

# 下载彩色图像

我们还提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图像。您可以在这里下载：[`www.packtpub.com/sites/default/files/downloads/9781789612905_ColorImages.pdf`](http://www.packtpub.com/sites/default/files/downloads/9781789612905_ColorImages.pdf)。

# 代码实例

访问以下链接查看代码运行的视频：[`bit.ly/2M3QVrl`](http://bit.ly/2M3QVrl)

# 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄。这是一个例子：“HTML 文档是按层次结构构建的，最外层的标签通常是`<html>`。”

代码块设置如下：

```py
<table border=2>
      <thead>
        <tr bgcolor='grey'><th>System</th><th>Graphics</th><th>Sound</th></tr>
      </thead>
```

当我们希望引起您对代码块的特定部分的注意时，相关行或项目将以粗体显示：

```py
<table border=2>
      <thead>
        <tr bgcolor='grey'><th>System</th><th>Graphics</th><th>Sound</th></tr>
      </thead>
```

任何命令行输入或输出都以以下方式编写：

```py
$ python game_lobby.py
Font is Totally Nonexistent Font Family XYZ
Actual font used is Bitstream Vera Sans
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词会以这样的方式出现在文本中。这是一个例子：“从管理面板中选择系统信息。”

警告或重要说明会以这种方式出现。提示和技巧会以这种方式出现。
