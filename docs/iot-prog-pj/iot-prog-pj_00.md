# 前言

物联网承诺解锁真实世界，就像互联网几十年前解锁了数百万台计算机一样。树莓派计算机于 2012 年首次发布，迅速风靡全球。最初设计的目的是给新一代带来与上世纪 80 年代个人计算机同样的编程激情，树莓派已经成为无数创客的标配。

1991 年，Guido van Rossum 向世界介绍了 Python 编程语言。Python 是一种简洁的语言，旨在提高代码可读性。Python 程序往往需要的代码行数比其他编程语言少。Python 是一种可扩展的语言，可用于从最简单的程序到大规模项目。

在本书中，我们将释放树莓派和 Python 的力量，创建令人兴奋的物联网项目。

本书的第一部分向读者介绍了令人惊叹的树莓派。我们将学习如何设置它，并立即开始 Python 编程。我们将通过为物理计算创建“Hello World”应用程序——闪烁 LED，开始我们的真实计算之旅。

我们的第一个项目将我们带回到模拟指针仪表统治数据显示领域的年代。回想一下那些旧的模拟万用表和无数的旧科幻电影，信息是通过按钮和大型闪烁灯控制和显示的。在我们的项目中，我们将从网络服务中检索天气数据，并在模拟指针仪表上显示它。我们将通过 GPIO 将舵机连接到我们的树莓派，实现这一目标。

家庭安全系统在现代生活中几乎无处不在。整个行业和职业都建立在安装和监控这些系统上。你知道吗，你可以轻松地创建自己的家庭安全系统吗？在我们的第二个项目中，我们就是这样做的，我们使用树莓派作为 Web 服务器来构建家庭安全系统。

自 1831 年以来，谦卑的门铃一直与我们同在。在我们的第三个项目中，我们将给它增加 21 世纪的变化，让我们的树莓派向网络服务发送信号，当有人来敲门时，网络服务将给我们发短信。

在我们的最后一个项目中，我们将从前两个项目中学到的知识创建一个名为 T.A.R.A.S（这个令人惊叹的树莓派自动安全代理）的物联网机器人车。

未来，无人驾驶汽车将成为规则而不是例外，需要一种控制这些汽车的方式。这个最后的项目为读者提供了洞察和知识，了解如何控制没有人类驾驶员的汽车。

# 这本书是为谁写的

本书面向那些对编程有一定了解并对物联网感兴趣的人。了解 Python 编程语言将是一个明显的优势。对面向对象编程的理解或浓厚的兴趣将有助于读者理解本书中使用的编码示例。

# 本书内容

第一章《在树莓派上安装 Raspbian》通过在树莓派上安装 Raspbian 操作系统开始了我们的树莓派物联网之旅。然后我们将看一些预装在 Raspbian 上的程序。

第二章《使用树莓派编写 Python 程序》介绍了 Windows、macOS 和 Linux 这些对开发人员来说很熟悉的操作系统。许多关于开发树莓派的书籍都涉及使用其中一个操作系统并远程访问树莓派。但本书将采用不同的方法，我们将把树莓派作为开发机器。在本章中，我们将初步了解如何将树莓派作为开发机器。

第三章，“使用 GPIO 连接外部世界”，解释了如果树莓派只是一台 35 美元的计算机，对我们许多人来说已经足够了。然而，树莓派背后真正的力量在于开发者通过**通用输入输出**（**GPIO**）引脚访问外部世界的能力。在本章中，我们将深入研究 GPIO，并开始将树莓派连接到现实世界。我们将使用外部 LED 创建一个莫尔斯电码生成器，然后使用这个生成器来闪烁模拟的天气信息。

第四章，“订阅 Web 服务”，探讨了一些世界上一些最大公司提供的一些网络服务。我们的项目将使用虚拟版本的树莓派 Sense HAT 作为滚动条，显示来自 Yahoo! Weather 网络服务的当前天气信息。

第五章，“使用 Python 控制舵机”，介绍了使用连接到树莓派的舵机电机创建模拟仪表针的概念。

第六章，“使用舵机控制代码控制模拟设备”，继续讨论使用舵机电机的主题，因为我们正在构建我们的第一个真正的物联网设备，一个天气仪表盘。这个天气仪表盘不仅会有一个模拟指针；它还将使用指针指向根据天气条件建议的衣柜图片。

第七章，“设置树莓派 Web 服务器”，介绍了如何安装和配置 Web 框架 CherryPy。我们将通过构建一个显示天气信息的本地网站来结束本章。

第八章，“使用 Python 读取树莓派 GPIO 传感器数据”，介绍了如何在转移到 PIR 传感器和距离传感器之前读取按钮的状态。我们将通过构建简单的报警系统来结束本章。

第九章，“构建家庭安全仪表盘”，解释了如何使用树莓派作为提供从 GPIO 收集的传感器数据的 HTML 内容的 Web 服务器来构建家庭安全仪表盘。

第十章，“发布到 Web 服务”，介绍了如何测量室温和湿度，并通过物联网仪表板将这些值发布到网络上。我们还将设置并运行使用 Twilio 服务的短信警报。

第十一章，“使用蓝牙创建门铃按钮”，将我们的重点转向本章中的蓝牙使用。蓝牙是一种无线技术，允许在短距离内传输数据。对于我们的项目，我们将探索 Android Play 商店中的 BlueDot 应用。我们将使用这个应用来构建一个简单的蓝牙连接门铃。

第十二章，“增强我们的物联网门铃”，将我们在“使用蓝牙创建门铃按钮”中创建的简单门铃转变为物联网门铃，使用我们在“发布到 Web 服务”中学到的知识。

第十三章，“介绍树莓派机器人车”，通过介绍这个令人惊叹的树莓派自动安全代理（T.A.R.A.S）开始了我们进入物联网机器人车的旅程。本章将首先概述我们构建 T.A.R.A.S 所需的组件，然后我们将继续将它们全部组装起来。

第十四章，*使用 Python 控制机器人车*，介绍了如何为我们的机器人车编写 Python 代码。我们将利用 GPIO Zero 库使车轮向前转动，移动携带摄像头的伺服电机，并点亮机器人车后面的 LED 灯。

第十五章，*将机器人车的感应输入连接到网络*，帮助我们理解，为了将我们的机器人车变成真正的物联网设备，我们必须将其连接到互联网。在本章中，我们将把机器人车的距离传感器连接到互联网。

第十六章，*通过 Web 服务调用控制机器人车*，继续将我们的机器人车变成物联网设备，深入研究了我们为机器人车创建的互联网仪表板。

第十七章，*构建 JavaScript 客户端*，将我们的注意力从 Python 转移到 JavaScript。我们将使用 JavaScript 构建一个基于 Web 的客户端，使用 MQTT 协议在互联网上进行通信。

第十八章，*将所有内容整合在一起*，介绍了我们将如何将我们的机器人车 T.A.R.A.S 连接到 JavaScript 客户端，并使用 MQTT 协议在互联网上进行控制。

# 为了充分利用本书

为了充分利用本书，我将假设以下情况：

+   您已经购买或将购买一台树莓派计算机，最好是 2015 年或更新的型号。

+   您对 Python 编程语言有一定了解，或者渴望学习它。

+   您对电子元件有基本的了解，并知道如何使用面包板。

+   您已经购买或愿意购买基本的电子元件。

在硬件需求方面，您至少需要以下设备：

+   一个树莓派 3 型号（2015 年或更新的型号）

+   一个 USB 电源适配器

+   一台计算机显示器

+   一个 USB 键盘

+   一个 USB 鼠标

+   一张 microSD RAM 卡

+   一个面包板和面包板跳线

每章节开始时会介绍额外的硬件部件。

在软件需求方面，您将需要树莓派 NOOBS 镜像（[`www.raspberrypi.org/downloads/noobs/`](https://www.raspberrypi.org/downloads/noobs/)）。额外的软件、账户和 Python 包将在途中介绍。本书中使用的任何软件、网络服务或 Python 包都是免费的。

# 下载示例代码文件

您可以从您在[www.packt.com](http://www.packt.com)的账户中下载本书的示例代码文件。如果您在其他地方购买了本书，您可以访问[www.packt.com/support](http://www.packt.com/support)并注册，以便直接通过电子邮件接收文件。

您可以按照以下步骤下载代码文件：

1.  在[www.packt.com](http://www.packt.com)上登录或注册。

1.  选择“支持”选项卡。

1.  点击“代码下载和勘误”。

1.  在“搜索”框中输入书名，然后按照屏幕上的说明操作。

下载文件后，请确保使用以下最新版本解压或提取文件夹：

+   Windows 上的 WinRAR/7-Zip

+   Mac 上的 Zipeg/iZip/UnRarX

+   Linux 上的 7-Zip/PeaZip

本书的代码捆绑包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/Internet-of-Things-Programming-Projects`](https://github.com/PacktPublishing/Internet-of-Things-Programming-Projects)。如果代码有更新，将在现有的 GitHub 存储库上进行更新。

我们还有其他代码捆绑包，来自我们丰富的图书和视频目录，可在**[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)**上找到。去看看吧！

# 下载彩色图片

我们还提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图像。您可以在这里下载：[`www.packtpub.com/sites/default/files/downloads/9781789134803_ColorImages.pdf`](https://www.packtpub.com/sites/default/files/downloads/9781789134803_ColorImages.pdf)。

# 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄。这是一个例子：“为了访问 Python 3，我们在终端窗口中输入  `python3` 命令。”

代码块设置如下：

```py
wind_dir_str_len = 2
if currentWeather.getWindSpeed()[-2:-1] == ' ':
    wind_dir_str_len = 1
```

任何命令行输入或输出都以以下方式编写：

```py
pip3 install weather-api
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词会以这种方式出现在文本中。这是一个例子：“从 视图 菜单中，选择 对象检查器 和 变量。”

警告或重要说明会以这种方式出现。提示和技巧会以这种方式出现。
