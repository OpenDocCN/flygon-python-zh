# 前言

我们都可能花费时间进行一些不太有价值的小手动任务。可能是在信息来源中搜索相关信息的小片段，使用电子表格一遍又一遍生成相同的图表，或者逐个搜索文件直到找到我们正在寻找的数据。其中一些——可能是大多数——任务实际上是可以自动化的。一开始需要投入一些时间，但对于那些一遍又一遍重复的任务，我们可以使用计算机来执行这些琐碎的任务，并将自己的努力集中在人类擅长的高级分析和基于结果的决策上。本书将解释如何使用Python语言来自动化可以大大加快计算机执行的常见业务任务。

鉴于Python的表现力和易用性，开始制作执行这些操作并将它们组合成更完整系统的小程序实际上非常简单。在整本书中，我们将展示一些小而易于遵循的配方，可以根据您的特定需求进行调整，并将它们组合起来执行更复杂的操作。我们将执行常见的操作，例如通过网络爬虫检测机会，分析信息以生成带有图表的自动电子表格报告，通过自动生成的电子邮件进行通信，通过短信获取通知，并学习如何在您专注于其他更重要的事情时运行任务。

尽管需要一些Python知识，但本书是针对非程序员编写的，提供清晰和有指导性的配方，可以提高读者的熟练程度，同时针对特定的日常目标。

# 这本书适合谁

这本书适合Python初学者，不一定是开发人员，他们希望利用和扩展他们的知识来自动化任务。本书中的大多数示例都针对营销、销售和其他非技术领域。读者需要了解一些Python语言，包括其基本概念。

# 本书涵盖的内容

第1章，“让我们开始自动化之旅”，介绍了整本书中将使用的一些基本内容。它描述了如何通过虚拟环境安装和管理第三方工具，如何进行有效的字符串操作，如何使用命令行参数，并向您介绍了正则表达式和其他文本处理方法。

第2章，“轻松自动化任务”，展示了如何准备并自动运行任务。它涵盖了如何编程任务以在应该执行时执行，而不是手动运行它们；如何在自动运行的任务的结果通知；以及如何在自动化过程中出现错误时得到通知。

第3章，“构建您的第一个网络爬虫应用程序”，探讨了发送网络请求以与外部网站以不同格式进行通信，如原始HTML内容；结构化的反馈；RESTful API；甚至自动执行浏览器步骤而无需手动干预。它还涵盖了如何处理结果以提取相关信息。

第4章，“搜索和阅读本地文件”，解释了如何搜索本地文件和目录并分析存储在那里的信息。您将学习如何在不同编码中过滤相关文件并阅读几种常见格式的文件，如CSV、PDF、Word文档，甚至图像。

第5章，“生成精彩的报告”，探讨了如何以多种格式显示文本格式中给出的信息。这包括创建模板以生成文本文件，以及创建格式丰富且样式良好的Word和PDF文档。

第6章，“电子表格的乐趣”，探讨了如何以CSV格式读取和写入电子表格；在功能丰富的Microsoft Excel中，包括格式和图表；以及在LibreOffice中，这是Microsoft Excel的免费替代品。

第7章，“开发令人惊叹的图表”，解释了如何生成美丽的图表，包括常见的示例，如饼图、折线图和条形图，以及其他高级情况，如堆叠条形图甚至地图。它还解释了如何组合和设计多个图表，以生成丰富的图形，并以易于理解的格式显示相关信息。

第8章，“处理通信渠道”，解释了如何在多个渠道发送消息，使用外部工具来完成大部分繁重的工作。本章涉及单独发送和接收电子邮件，以及通过短信进行通信，以及在Telegram中创建机器人。

第9章，“为什么不自动化您的营销活动？”，结合了本书中包含的不同配方，生成了一个完整的营销活动，包括机会检测、促销生成、向潜在客户的沟通，以及分析和报告促销产生的销售。本章展示了如何结合不同的元素，创建强大的系统。

第10章，“调试技术”，介绍了不同的方法和技巧，以帮助调试过程，并确保软件的质量。它利用了Python的强大内省能力和其开箱即用的调试工具，用于修复问题和生成可靠的自动化软件。

# 为了充分利用本书

在阅读本书之前，读者需要了解Python语言的基础知识。我们不假设读者是该语言的专家。

读者需要知道如何在命令行（终端、Bash或等效工具）中输入命令。

要理解本书中的代码，您需要一个文本编辑器，它将使您能够阅读和编辑代码。您可以使用支持Python语言的集成开发环境，如PyCharm和PyDev——您可以自行选择。请查看此链接以获取有关集成开发环境的想法：[https://realpython.com/python-ides-code-editors-guide/](https://realpython.com/python-ides-code-editors-guide/)。

# 下载示例代码文件

您可以从[www.packt.com](http://www.packt.com)的帐户中下载本书的示例代码文件。如果您在其他地方购买了本书，可以访问[www.packt.com/support](http://www.packt.com/support)并注册，以便直接将文件发送到您的邮箱。

您可以按照以下步骤下载代码文件：

1.  在[www.packt.com](http://www.packt.com/support)上登录或注册。

1.  选择“支持”选项卡。

1.  单击“代码下载和勘误”。

1.  在搜索框中输入书名，然后按照屏幕上的说明操作。

下载文件后，请确保使用最新版本的解压缩或提取文件夹：

+   Windows上的WinRAR/7-Zip

+   Mac上的Zipeg/iZip/UnRarX

+   Linux上的7-Zip/PeaZip

该书的代码包也托管在GitHub上，网址为[https://github.com/PacktPublishing/Python-Automation-Cookbook](https://github.com/PacktPublishing/Python-Automation-Cookbook)。如果代码有更新，将在现有的GitHub存储库上进行更新。

我们还有来自我们丰富书籍和视频目录的其他代码包，可在**[https://github.com/PacktPublishing/](https://github.com/PacktPublishing/)**上找到。去看看吧！

# 下载彩色图像

我们还提供了一个PDF文件，其中包含本书中使用的屏幕截图/图表的彩色图像。您可以从[https://www.packtpub.com/sites/default/files/downloads/9781789133806_ColorImages.pdf](https://www.packtpub.com/sites/default/files/downloads/9781789133806_ColorImages.pdf)下载它。

# 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码词、对象名称、模块名称、文件夹名称、文件名、文件扩展名、路径名、虚拟URL和用户输入。这里有一个例子：“对于这个食谱，我们需要导入`requests`模块。”

代码块设置如下：

```py
# IMPORTS
from sale_log import SaleLog

def get_logs_from_file(shop, log_filename):
def main(log_dir, output_filename):
    ...

if __name__ == '__main__':
  # PARSE COMMAND LINE ARGUMENTS AND CALL main()
```

请注意，代码可能会被编辑以简洁和清晰。必要时请参考完整的代码，可在GitHub上找到。

任何命令行输入或输出都是这样写的（注意`$`符号）：

```py
$ python execute_script.py parameters
```

Python解释器中的任何输入都是这样写的（注意`>>>`符号）：

```py
>>> import delorean
>>> timestamp = delorean.utcnow().datetime.isoformat()
```

要进入Python解释器，请使用`python3`命令而不带任何参数：

```py
$ python3 
Python 3.7.0 (default, Aug 22 2018, 15:22:33)
[Clang 9.1.0 (clang-902.0.39.2)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>>
```

**验证Python解释器是否为Python 3.7或更高版本**。可能需要调用`python`或`python3.7`，具体取决于您的操作系统和安装选项。有关使用不同Python解释器的更多详细信息，请参见[第1章，](e139aa50-5631-4b75-9257-d4eb2e12ef90.xhtml)特别是*创建虚拟环境*食谱。

**粗体**：表示一个新术语、一个重要词或屏幕上看到的词。例如，菜单或对话框中的单词会以这样的形式出现在文本中。这里有一个例子：“转到账户|附加功能|API密钥并创建一个新的：”

警告或重要说明会出现在这样的形式中。提示和技巧会出现在这样的形式中。

# 章节

在这本书中，你会发现一些经常出现的标题（*准备工作*、*如何做*、*它是如何工作的*、*还有更多*和*另请参阅*）。

# 准备工作

这一部分告诉你在食谱中可以期待什么，并描述如何设置食谱所需的任何软件或任何初步设置。

# 如何做...

这一部分包含了遵循食谱所需的步骤。

# 它是如何工作的...

这一部分通常包括对前一部分发生的事情的详细解释。

# 还有更多...

这一部分包含了有关食谱的额外信息，以使您对食谱更加了解。

# 另请参阅

这一部分提供了与食谱相关的其他有用信息的链接。
