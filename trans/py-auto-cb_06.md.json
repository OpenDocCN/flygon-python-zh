["```py\n>>> import csv\n```", "```py\n>>> HEADER = ('Admissions', 'Name', 'Year')\n>>> DATA = [\n... (225.7, 'Gone With the Wind', 1939),\n... (194.4, 'Star Wars', 1977),\n... (161.0, 'ET: The Extra-Terrestrial', 1982)\n... ]\n```", "```py\n>>> with open('movies.csv', 'w',  newline='') as csvfile:\n...     movies = csv.writer(csvfile)\n...     movies.writerow(HEADER)\n...     for row in DATA:\n...         movies.writerow(row)\n```", "```py\n>>> import csv\n>>> FILENAME = 'movies.csv'\n```", "```py\n>>> with open(FILENAME, newline='') as file:\n...     data = [row for row in csv.DictReader(file)]\n```", "```py\n>>> data\n[OrderedDict([('Admissions', '225.7'), ('Name', 'Gone With the Wind'), ('Year', '1939')]), OrderedDict([('Admissions', '194.4'), ('Name', 'Star Wars'), ('Year', '1968')]), OrderedDict([('Admissions', '161.0'), ('Name', 'ET: The Extra-Terrestrial'), ('Year', '1982')])]\n>>> data[1]['Year']\n'1968'\n>>> data[1]['Year'] = '1977'\n```", "```py\n>>> HEADER = data[0].keys()\n>>> with open(FILENAME, 'w', newline='') as file:\n...     writer = csv.DictWriter(file, fieldnames=HEADER)\n...     writer.writeheader()\n...     writer.writerows(data)\n```", "```py\n>>> with open(FILENAME, newline='') as file:\n...    dialect = csv.Sniffer().sniff(file.read())\n```", "```py\n$ echo \"openpyxl==2.5.4\" >> requirements.txt\n$ pip install -r requirements.txt\n```", "```py\n>>> import openpyxl\n```", "```py\n>>> xlsfile = openpyxl.load_workbook('movies.xlsx')\n```", "```py\n>>> xlsfile.sheetnames\n['Sheet1']\n>>> sheet = xlsfile['Sheet1']\n```", "```py\n>>> sheet['B4'].value\n161\n>>> sheet['D4'].value\n'Steven Spielberg'\n```", "```py\n>>> sheet.max_row\n11\n>>> sheet.max_column\n4\n>>> sheet['A12'].value\n>>> sheet['E1'].value\n```", "```py\n>>> for row in sheet:\n...     for cell in row:\n...         # Do stuff with cell\n```", "```py\n>>> cell.coordinate\n'D4'\n>>> cell.column\n'D'\n>>> cell.row\n4\n```", "```py\n$ echo \"openpyxl==2.5.4\" >> requirements.txt\n$ pip install -r requirements.txt\n```", "```py\n>>> import openpyxl\n>>> from openpyxl.comments import Comment\n```", "```py\n>>> xlsfile = openpyxl.load_workbook('movies.xlsx')\n>>> sheet = xlsfile['Sheet1']\n```", "```py\n>>> sheet['D4'].value\n'Steven Spielberg'\n```", "```py\n>>> sheet['D4'].value = 'Spielberg'\n```", "```py\n>>> sheet['D4'].comment = Comment('Changed text automatically', 'User')\n```", "```py\n>>> sheet['B12'] = '=SUM(B2:B11)'\n```", "```py\n>>> xlsfile.save('movies_comment.xlsx')\n```", "```py\n>>> xlsfile = openpyxl.load_workbook('movies.xlsx', guess_types=True)\n>>> xlsfile['Sheet1']['A1'].value = '37%'\n>>> xlsfile['Sheet1']['A1'].value\n0.37\n>>> xlsfile['Sheet1']['A1'].value = '2.75'\n>>> xlsfile['Sheet1']['A1'].value\n2.75\n```", "```py\n$ echo \"openpyxl==2.5.4\" >> requirements.txt\n$ pip install -r requirements.txt\n```", "```py\n>>> import openpyxl\n```", "```py\n>>> xlsfile = openpyxl.Workbook()\n>>> xlsfile.sheetnames\n['Sheet']\n>>> sheet = xlsfile['Sheet']\n```", "```py\n>>> data = [\n...    (225.7, 'Gone With the Wind', 'Victor Fleming'),\n...    (194.4, 'Star Wars', 'George Lucas'),\n...    (161.0, 'ET: The Extraterrestrial', 'Steven Spielberg'),\n... ]\n>>> for row, (admissions, name, director) in enumerate(data, 1):\n...     sheet['A{}'.format(row)].value = admissions\n...     sheet['B{}'.format(row)].value = name\n```", "```py\n>>> sheet = xlsfile.create_sheet(\"Directors\")\n>>> sheet\n<Worksheet \"Directors\">\n>>> xlsfile.sheetnames\n['Sheet', 'Directors']\n```", "```py\n>>> for row, (admissions, name, director) in enumerate(data, 1):\n...    sheet['A{}'.format(row)].value = director\n...    sheet['B{}'.format(row)].value = name\n```", "```py\n>>> xlsfile.save('movie_sheets.xlsx')\n```", "```py\n>>> sheet = xlsfile['Sheet']\n>>> sheet.title = 'Admissions'\n>>> xlsfile.sheetnames\n['Admissions', 'Directors']\n```", "```py\n>> xlsfile.active\n<Worksheet \"Admissions\">\n>>> xlsfile._active_sheet_index\n0\n>>> xlsfile._active_sheet_index = 1\n>>> xlsfile.active\n<Worksheet \"Directors\">\n```", "```py\nnew_copied_sheet = xlsfile.copy_worksheet(source_sheet)\n```", "```py\n$ echo \"openpyxl==2.5.4\" >> requirements.txt\n$ pip install -r requirements.txt\n```", "```py\n>>> import openpyxl\n>>> from openpyxl.chart import BarChart, Reference\n>>> xlsfile = openpyxl.Workbook()\n```", "```py\n>>> data = [\n...     ('Name', 'Admissions'),\n...     ('Gone With the Wind', 225.7),\n...     ('Star Wars', 194.4),\n...     ('ET: The Extraterrestrial', 161.0),\n... ]\n>>> sheet = xlsfile['Sheet']\n>>> for row in data:\n... sheet.append(row)\n```", "```py\n>>> chart = BarChart()\n>>> chart.title = \"Admissions per movie\"\n>>> chart.y_axis.title = 'Millions'\n```", "```py\n>>> data = Reference(sheet, min_row=2, max_row=4, min_col=1, max_col=2)\n>>> chart.add_data(data, from_rows=True, titles_from_data=True)\n```", "```py\n>>> sheet.add_chart(chart, \"A6\")\n>>> xlsfile.save('movie_chart.xlsx')\n```", "```py\n>>> chart.type = 'bar'\n```", "```py\ndata = Reference(sheet, min_row=2, max_row=4, min_col=2, max_col=2)\nlabels = Reference(sheet, min_row=2, max_row=4, min_col=1, max_col=1)\nchart.add_data(data, from_rows=False, titles_from_data=False)\nchart.set_categories(labels)\n```", "```py\nchart.add_data('Sheet!B2:B4', from_rows=False, titles_from_data=False)\nchart.set_categories('Sheet!A2:A4')\n```", "```py\n$ echo \"openpyxl==2.5.4\" >> requirements.txt\n$ pip install -r requirements.txt\n```", "```py\n>>> import openpyxl\n>>> from openpyxl.styles import Font, PatternFill, Border, Side\n>>> xlsfile = openpyxl.Workbook()\n```", "```py\n>>> data = [\n...    ('Name', 'Admissions'),\n...    ('Gone With the Wind', 225.7),\n...    ('Star Wars', 194.4),\n...    ('ET: The Extraterrestrial', 161.0),\n...    ('The Sound of Music', 156.4),\n]\n>>> sheet = xlsfile['Sheet']\n>>> for row in data:\n...    sheet.append(row)\n```", "```py\n>>> BLUE = \"0033CC\"\n>>> LIGHT_BLUE = 'E6ECFF'\n>>> WHITE = \"FFFFFF\"\n```", "```py\n>>> header_font = Font(name='Tahoma', size=14, color=WHITE)\n>>> header_fill = PatternFill(\"solid\", fgColor=BLUE)\n>>> for row in sheet['A1:B1']:\n...     for cell in row:\n...         cell.font = header_font\n...         cell.fill = header_fill\n```", "```py\n>>> white_side = Side(border_style='thin', color=WHITE)\n>>> blue_side = Side(border_style='thin', color=BLUE)\n>>> alternate_fill = PatternFill(\"solid\", fgColor=LIGHT_BLUE)\n>>> border = Border(bottom=blue_side, left=white_side, right=white_side)\n>>> for row_index, row in enumerate(sheet['A2:B5']):\n...     for cell in row:\n...         cell.border = border\n...         if row_index % 2:\n...             cell.fill = alternate_fill\n```", "```py\n>>> xlsfile.save('movies_format.xlsx')\n```", "```py\ncell.style = 'Percent'\n```", "```py\n$ python include_macro.py -h\nusage: It inserts the macro file \"script\" into the file \"spreadsheet\" in .ods format. The resulting file is located in the macro_file directory, that will be created\n [-h] spreadsheet script\n\npositional arguments:\n spreadsheet File to insert the script\n script Script to insert in the file\n\noptional arguments:\n -h, --help show this help message and exit\n\n$ python include_macro.py movies.ods libreoffice_script.py\n```", "```py\ndef ObtainAggregated(*args):\n    \"\"\"Prints the Python version into the current document\"\"\"\n    # get the doc from the scripting context\n    # which is made available to all scripts\n    desktop = XSCRIPTCONTEXT.getDesktop()\n    model = desktop.getCurrentComponent()\n    # get the first sheet\n    sheet = model.Sheets.getByIndex(0)\n\n    # Find the admissions column\n    MAX_ELEMENT = 20\n    for column in range(0, MAX_ELEMENT):\n        cell = sheet.getCellByPosition(column, 0)\n        if 'Admissions' in cell.String:\n            break\n    else:\n        raise Exception('Admissions not found')\n\n    accumulator = 0.0\n    for row in range(1, MAX_ELEMENT):\n        cell = sheet.getCellByPosition(column, row)\n        value = cell.getValue()\n        if value:\n            accumulator += cell.getValue()\n        else:\n            break\n\n    cell = sheet.getCellByPosition(column, row)\n    cell.setValue(accumulator)\n\n    cell = sheet.getCellRangeByName(\"A15\")\n    cell.String = 'Total'\n    return None\n```"]