- en: Preface
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 前言
- en: We are all probably spending time doing small manual tasks that don't add much
    value. It may be scanning through information sources in search of the small bits
    of relevant information, working with spreadsheets to generate the same graph
    over and over, or searching files one by one until find the data we're looking
    for. Some—probably most—of those tasks are, in fact, automatable. There's an investment
    upfront, but for the tasks that get repeated over and over, we can use computers
    to do these kinds of menial tasks and focus our own efforts instead on what humans
    are good for—high-level analysis and decision making based on the result. This
    book will explain how to use the Python language to automatize common business
    tasks that can be greatly sped up if a computer is doing them.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 我们都可能花费时间进行一些不太有价值的小手动任务。可能是在信息来源中搜索相关信息的小片段，使用电子表格一遍又一遍生成相同的图表，或者逐个搜索文件直到找到我们正在寻找的数据。其中一些——可能是大多数——任务实际上是可以自动化的。一开始需要投入一些时间，但对于那些一遍又一遍重复的任务，我们可以使用计算机来执行这些琐碎的任务，并将自己的努力集中在人类擅长的高级分析和基于结果的决策上。本书将解释如何使用Python语言来自动化可以大大加快计算机执行的常见业务任务。
- en: Given the expressiveness and ease of use of Python, it's surprisingly simple
    to start making small programs to perform these actions and combine them into
    more integrated systems. Throughout the book, we will show small, easy-to-follow
    recipes that can be adapted to your specific needs, and we will combine them to
    perform more complex actions. We will perform common actions, such as detecting
    opportunities by scraping the web, analyzing information to generate automatic
    spreadsheet reports with graphs, communicating with automatically generated emails,
    getting notifications via text messages, and learning how to run tasks while your
    mind is focused on other more important stuff.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于Python的表现力和易用性，开始制作执行这些操作并将它们组合成更完整系统的小程序实际上非常简单。在整本书中，我们将展示一些小而易于遵循的配方，可以根据您的特定需求进行调整，并将它们组合起来执行更复杂的操作。我们将执行常见的操作，例如通过网络爬虫检测机会，分析信息以生成带有图表的自动电子表格报告，通过自动生成的电子邮件进行通信，通过短信获取通知，并学习如何在您专注于其他更重要的事情时运行任务。
- en: Though some Python knowledge is required, the book is written with non-programmers
    in mind, giving clear and instructive recipes that will further the reader's proficiency
    while being oriented to specific day-to-day goals.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管需要一些Python知识，但本书是针对非程序员编写的，提供清晰和有指导性的配方，可以提高读者的熟练程度，同时针对特定的日常目标。
- en: Who this book is for
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 这本书适合谁
- en: This book is for Python beginners, not necessarily developers, that want to
    use and expand their knowledge to automate tasks. Most of the examples in the
    book are aimed at marketing, sales, and other non-tech areas. The reader needs
    to know a little of the Python language, including its basic concepts.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 这本书适合Python初学者，不一定是开发人员，他们希望利用和扩展他们的知识来自动化任务。本书中的大多数示例都针对营销、销售和其他非技术领域。读者需要了解一些Python语言，包括其基本概念。
- en: What this book covers
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本书涵盖的内容
- en: '[Chapter 1](6b1d9f13-f2de-41f1-a87b-6896ceb7b280.xhtml), *Let Us Begin Our
    Automation Journey, * presents some basic content that will be used all through
    the book. It describes how to install and manage third-party tools through virtual
    environments, how to do effective string manipulation, how to use command-line
    arguments, and introduces you to regular expressions and other methods of text
    processing.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 第1章，“让我们开始自动化之旅”，介绍了整本书中将使用的一些基本内容。它描述了如何通过虚拟环境安装和管理第三方工具，如何进行有效的字符串操作，如何使用命令行参数，并向您介绍了正则表达式和其他文本处理方法。
- en: '[Chapter 2](d640524b-3aa3-406e-a6d4-842bc61c4658.xhtml), *Automating Tasks
    Made Easy*, shows how to prepare and automatically run tasks. It covers how to
    program tasks to be executed when they should, instead of running them manually;
    how to be notified with the result of a task that''s run automatically; and how
    to be notified if there has been an error in an automated process.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 第2章，“轻松自动化任务”，展示了如何准备并自动运行任务。它涵盖了如何编程任务以在应该执行时执行，而不是手动运行它们；如何在自动运行的任务的结果通知；以及如何在自动化过程中出现错误时得到通知。
- en: '[Chapter 3](e8536572-46e4-41ec-87b8-7f775fd61e63.xhtml), *Building Your First
    Web Scraping Application*, explores sending web requests to communicate with external
    websites in different formats, such as raw HTML content; structured feeds; RESTful
    APIs; and even automating a browser to execute steps without manual intervention.
    It also covers how to process results to extract relevant information.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 第3章，“构建您的第一个网络爬虫应用程序”，探讨了发送网络请求以与外部网站以不同格式进行通信，如原始HTML内容；结构化的反馈；RESTful API；甚至自动执行浏览器步骤而无需手动干预。它还涵盖了如何处理结果以提取相关信息。
- en: '[Chapter 4](404a9dc7-22f8-463c-9f95-b480dc17518d.xhtml), *Searching and Reading
    Local Files*, explains how to search through local files and directories and analyze
    the information stored there. You will learn how to filter through relevant files
    in different encodings and read files in several common formats, such as CSVs,
    PDFs, Word documents, and even images.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 第4章，“搜索和阅读本地文件”，解释了如何搜索本地文件和目录并分析存储在那里的信息。您将学习如何在不同编码中过滤相关文件并阅读几种常见格式的文件，如CSV、PDF、Word文档，甚至图像。
- en: '[Chapter 5](2f949287-3e2a-4aaa-b59c-e2662522f2c5.xhtml), *Generating Fantastic
    Reports*, looks at how to display information given in text format in multiple
    formats. This includes creating templates to produce text files, as well as creating
    richly formatted and properly styled Word and PDF documents.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 第5章，“生成精彩的报告”，探讨了如何以多种格式显示文本格式中给出的信息。这包括创建模板以生成文本文件，以及创建格式丰富且样式良好的Word和PDF文档。
- en: '[Chapter 6](aefbed90-7a63-4611-b430-85d216ab03c0.xhtml), *Fun with Spreadsheets*, explores
    how to read and write spreadsheets in the CSV format; in rich Microsoft Excel,
    including with formatting and charts; and in LibreOffice, a free alternative to
    Microsoft Excel.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 第6章，“电子表格的乐趣”，探讨了如何以CSV格式读取和写入电子表格；在功能丰富的Microsoft Excel中，包括格式和图表；以及在LibreOffice中，这是Microsoft
    Excel的免费替代品。
- en: '[Chapter 7](8c793eca-22a6-4688-afa9-e5175b4fb380.xhtml), *Developing Stunning
    Graphs*, explain how to produce beautiful charts, including common examples such
    as pie, line, and bar charts, as well as other advanced cases, such as stacked
    bars and even maps. It also explains how multiple graphs can be combined and styled
    to generate rich graphics and show relevant information in an understandable format.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 第7章，“开发令人惊叹的图表”，解释了如何生成美丽的图表，包括常见的示例，如饼图、折线图和条形图，以及其他高级情况，如堆叠条形图甚至地图。它还解释了如何组合和设计多个图表，以生成丰富的图形，并以易于理解的格式显示相关信息。
- en: Chapter 8, *Dealing with Communication Channels*, explains how to send messages
    in multiple channels, using external tools to do the most of the heavy lifting.
    This chapter goes into sending and receiving emails individually as well as *en
    masse*, communicating through SMS messages, and creating a bot in Telegram.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 第8章，“处理通信渠道”，解释了如何在多个渠道发送消息，使用外部工具来完成大部分繁重的工作。本章涉及单独发送和接收电子邮件，以及通过短信进行通信，以及在Telegram中创建机器人。
- en: Chapter 9, *Why Not Automate Your Marketing Campaign?*, combines the different
    recipes included in the book to generate a full marketing campaign, including
    steps such as detection of opportunity, generation of promotion, communication
    to potential customers, and analyzing and reporting sales produced by promotion.
    This chapter shows how to combine different elements to create powerful systems.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 第9章，“为什么不自动化您的营销活动？”，结合了本书中包含的不同配方，生成了一个完整的营销活动，包括机会检测、促销生成、向潜在客户的沟通，以及分析和报告促销产生的销售。本章展示了如何结合不同的元素，创建强大的系统。
- en: Chapter 10, *Debugging Techniques*, features different methods and tips to help
    in the debugging process and ensure the quality of your software. It leverages
    the great introspection capabilities of Python and its out-of-the-box debugging
    tools for fixing problems and producing solid automated software.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 第10章，“调试技术”，介绍了不同的方法和技巧，以帮助调试过程，并确保软件的质量。它利用了Python的强大内省能力和其开箱即用的调试工具，用于修复问题和生成可靠的自动化软件。
- en: To get the most out of this book
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为了充分利用本书
- en: Before reading this book, readers need to know the basics of the Python language.
    We do not assume that the reader is an expert in the language.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在阅读本书之前，读者需要了解Python语言的基础知识。我们不假设读者是该语言的专家。
- en: The reader needs to know how to input commands in the command line (Terminal,
    Bash, or equivalent).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 读者需要知道如何在命令行（终端、Bash或等效工具）中输入命令。
- en: To understand the code in this book, you need a text editor, which will enable
    you to read and edit the code. You can use an IDE that supports the Python language,
    such as PyCharm and PyDev—which you choose is up to you. Check out this link for
    ideas about IDEs: [https://realpython.com/python-ides-code-editors-guide/](https://realpython.com/python-ides-code-editors-guide/).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 要理解本书中的代码，您需要一个文本编辑器，它将使您能够阅读和编辑代码。您可以使用支持Python语言的集成开发环境，如PyCharm和PyDev——您可以自行选择。请查看此链接以获取有关集成开发环境的想法：[https://realpython.com/python-ides-code-editors-guide/](https://realpython.com/python-ides-code-editors-guide/)。
- en: Download the example code files
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 下载示例代码文件
- en: You can download the example code files for this book from your account at [www.packt.com](http://www.packt.com).
    If you purchased this book elsewhere, you can visit [www.packt.com/support](http://www.packt.com/support)
    and register to have the files emailed directly to you.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从[www.packt.com](http://www.packt.com)的帐户中下载本书的示例代码文件。如果您在其他地方购买了本书，可以访问[www.packt.com/support](http://www.packt.com/support)并注册，以便直接将文件发送到您的邮箱。
- en: 'You can download the code files by following these steps:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以按照以下步骤下载代码文件：
- en: Log in or register at [www.packt.com](http://www.packt.com/support).
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在[www.packt.com](http://www.packt.com/support)上登录或注册。
- en: Select the SUPPORT tab.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择“支持”选项卡。
- en: Click on Code Downloads & Errata.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击“代码下载和勘误”。
- en: Enter the name of the book in the Search box and follow the onscreen instructions.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在搜索框中输入书名，然后按照屏幕上的说明操作。
- en: 'Once the file is downloaded, please make sure that you unzip or extract the
    folder using the latest version of:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 下载文件后，请确保使用最新版本的解压缩或提取文件夹：
- en: WinRAR/7-Zip for Windows
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows上的WinRAR/7-Zip
- en: Zipeg/iZip/UnRarX for Mac
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Mac上的Zipeg/iZip/UnRarX
- en: 7-Zip/PeaZip for Linux
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux上的7-Zip/PeaZip
- en: The code bundle for the book is also hosted on GitHub at [https://github.com/PacktPublishing/Python-Automation-Cookbook](https://github.com/PacktPublishing/Python-Automation-Cookbook). In
    case there's an update to the code, it will be updated on the existing GitHub
    repository.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 该书的代码包也托管在GitHub上，网址为[https://github.com/PacktPublishing/Python-Automation-Cookbook](https://github.com/PacktPublishing/Python-Automation-Cookbook)。如果代码有更新，将在现有的GitHub存储库上进行更新。
- en: We also have other code bundles from our rich catalog of books and videos available
    at **[https://github.com/PacktPublishing/](https://github.com/PacktPublishing/)**.
    Check them out!
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还有来自我们丰富书籍和视频目录的其他代码包，可在**[https://github.com/PacktPublishing/](https://github.com/PacktPublishing/)**上找到。去看看吧！
- en: Download the color images
  id: totrans-34
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 下载彩色图像
- en: We also provide a PDF file that has color images of the screenshots/diagrams
    used in this book. You can download it [https://www.packtpub.com/sites/default/files/downloads/9781789133806_ColorImages.pdf](https://www.packtpub.com/sites/default/files/downloads/9781789133806_ColorImages.pdf).
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还提供了一个PDF文件，其中包含本书中使用的屏幕截图/图表的彩色图像。您可以从[https://www.packtpub.com/sites/default/files/downloads/9781789133806_ColorImages.pdf](https://www.packtpub.com/sites/default/files/downloads/9781789133806_ColorImages.pdf)下载它。
- en: Conventions used
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用的约定
- en: There are a number of text conventions used throughout this book.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 本书中使用了许多文本约定。
- en: '`CodeInText`: Indicates code words in text, object names, module names, folder
    names, filenames, file extensions, pathnames, dummy URLs and user input. Here
    is an example: "For this recipe, we need to import the `requests` module."'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '`CodeInText`：表示文本中的代码词、对象名称、模块名称、文件夹名称、文件名、文件扩展名、路径名、虚拟URL和用户输入。这里有一个例子：“对于这个食谱，我们需要导入`requests`模块。”'
- en: 'A block of code is set as follows:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 代码块设置如下：
- en: '[PRE0]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Note that code may be edited for concision and clarity. Refer to the full code
    when necessary, which is available at GitHub.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，代码可能会被编辑以简洁和清晰。必要时请参考完整的代码，可在GitHub上找到。
- en: 'Any command-line input or output is written as follows (notice the `$` symbol):'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 任何命令行输入或输出都是这样写的（注意`$`符号）：
- en: '[PRE1]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Any input in the Python interpreter is written as follows (notice the `>>>`
    symbol):'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: Python解释器中的任何输入都是这样写的（注意`>>>`符号）：
- en: '[PRE2]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'To enter inside the Python interpreter, call the `python3` command with no
    parameters:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 要进入Python解释器，请使用`python3`命令而不带任何参数：
- en: '[PRE3]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '**Verify that the Python interpreter is Python 3.7 or higher**. It may be necessary
    to call `python` or `python3.7`, depending on your operating system and installation
    options. See [Chapter 1,](e139aa50-5631-4b75-9257-d4eb2e12ef90.xhtml) *Let Us
    Begin Our Automation Journey,* specifically the *Creating a virtual environment* recipe—for
    further details about the use of different Python interpreters.'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '**验证Python解释器是否为Python 3.7或更高版本**。可能需要调用`python`或`python3.7`，具体取决于您的操作系统和安装选项。有关使用不同Python解释器的更多详细信息，请参见[第1章，](e139aa50-5631-4b75-9257-d4eb2e12ef90.xhtml)特别是*创建虚拟环境*食谱。'
- en: '**Bold**: Indicates a new term, an important word, or words that you see onscreen.
    For example, words in menus or dialog boxes appear in the text like this. Here
    is an example: "Go to Account | Extras | API keys and create a new one:"'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '**粗体**：表示一个新术语、一个重要词或屏幕上看到的词。例如，菜单或对话框中的单词会以这样的形式出现在文本中。这里有一个例子：“转到账户|附加功能|API密钥并创建一个新的：”'
- en: Warnings or important notes appear like this.Tips and tricks appear like this.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 警告或重要说明会出现在这样的形式中。提示和技巧会出现在这样的形式中。
- en: Sections
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 章节
- en: In this book, you will find several headings that appear frequently (*Getting
    ready*, *How to do it...*, *How it works...*, *There's more...*, and *See also*).
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书中，你会发现一些经常出现的标题（*准备工作*、*如何做*、*它是如何工作的*、*还有更多*和*另请参阅*）。
- en: Getting ready
  id: totrans-53
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: This section tells you what to expect in the recipe and describes how to set
    up any software or any preliminary settings required for the recipe.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 这一部分告诉你在食谱中可以期待什么，并描述如何设置食谱所需的任何软件或任何初步设置。
- en: How to do it...
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做...
- en: This section contains the steps required to follow the recipe.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 这一部分包含了遵循食谱所需的步骤。
- en: How it works...
  id: totrans-57
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: This section usually consists of a detailed explanation of what happened in
    the previous section.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 这一部分通常包括对前一部分发生的事情的详细解释。
- en: There's more...
  id: totrans-59
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: This section consists of additional information about the recipe in order to
    make you more knowledgeable about the recipe.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 这一部分包含了有关食谱的额外信息，以使您对食谱更加了解。
- en: See also
  id: totrans-61
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另请参阅
- en: This section provides helpful links to other useful information for the recipe.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 这一部分提供了与食谱相关的其他有用信息的链接。
